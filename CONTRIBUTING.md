# Contributing to This Project

Thank you for your interest in contributing! We appreciate your help in improving this project. Please follow the guidelines below to ensure a smooth collaboration.

## Getting Started

1. **Clone the repository**: Run the following command to clone the repository to your local machine:
   ```sh
   git clone https://github.com/your-username/repository-name.git
   ```
   **Note**: for public repositories where you are not a member, you need to first create a
   "fork" of the repository to your own GitHub account before you can clone a local copy. To do this,
   click the "Fork" button at the top right of the repository page in the GitHub web
   interface to create your own copy. You will be able to push changes directly to your fork but
   not to the original repository. To suggest changes to the original repository,
   you will have to submit your changes via pull requests which will need to then
   be approved by the maintainers of the original repository. This system protects
   public repositories from degenerating into chaos.

2. **Navigate to the project directory**:
On your local machine:
   ```sh
   cd repository-name
   ```
3. **Add the upstream repository** (only needed once):
   ```sh
   git remote add upstream https://github.com/original-author/repository-name.git
   ```
4. **Fetch the latest changes**:
   ```sh
   git fetch upstream
   ```
5. **Checkout the main branch** and update:
   ```sh
   git checkout main
   git pull upstream main
   ```
6. **Replicate the required python environment on your local machine** (only needed once)
```sh
conda env create --name env-test-repo --file=environment.yaml
```
This assumes that you have conda (or better mamba) installed. IF not, you need
to install that first.

7. **Activate the python environment**
```sh
conda activate env-test-repo
```

## Summary of main workflow

1. Create feature branch from latest main

2. Work on your changes and test them locally.

3. Before opening a pull request (PR) rebase your feature branch onto the remotemain branch:
```
git fetch origin
git rebase origin/main
```

4. Fix any conflicts which arise locally

5. Push updated feature branch to the remote repo.

6. Go to GitHub.com and open the PR proposing to merge your feature branch into main.


## Creating a Feature Branch

1. **Create a new branch for your feature or bugfix**:
   ```sh
   # 1. Switch to main
   git checkout main

   # 2. Fetch latest changes from the remote
   git fetch origin

   # 3. Update your local main to match remote main
   git pull origin main

   # 4. Create and switch to your new feature branch
   git checkout -b feature-branch-name
   ```
   Use GitHub issues for feature tracking. Each new feature or bugfix should have
   an associated GitHub Issue. Issues are assigned to team members. It is good
   practice to name feature branches consistently with the associated issue.
2. **Make your changes** and test them locally.
3. **Commit your changes** with a meaningful message:
   ```sh
   git add .
   git commit -m "Brief description of changes"
   ```
4. **Push your changes to your fork**:
   ```sh
   git push origin feature-branch-name
   ```

## Creating a Pull Request

A pull request is a request to merge the changes you have made and tested in
your local feature branch back into the main branch. Before you start, make
sure you are on your local feature branch.

1. Rebase your local feature branch on the most recent main:
```
git fetch origin
git rebase origin/main
```
2. Locally resolve any conflicts which are generated by the rebase operation,
using ```git rebase --continue``` to proceed after each conflicting commit has
been fixed. Roughly, the process is the following:
    1. ```git status``` → See what’s broken

    2. Open each conflicted file

    3. Remove conflict markers and fix code

    4. ```git add <file>```

    5. ```git rebase --continue```

    6. Repeat until done

3. When all conflicts have been resolved and your code has been tested. Push your
local feature branch to the remote repository. Usually after rebasing, you will
need to do a forced push:
```
git push --force-with-lease
```
***Note:*** : forced push is only safe for a feature branch which is entirely your own. Never do a forced push to a shared branch.

4. Go to the original repository on GitHub.

5. Click on "Pull Requests" and then "New Pull Request."

6. Select your fork and branch, andi choose to "compare" it with the `main` branch of the original repository.

7. Add a title and description for your changes.

8. Click "Create Pull Request."

***Some extra links***:
- For some discussion of how conflicts are handled during rebase operations see [here](https://learning-ocean.com/tutorials/git/git-rebase-conflict-resolution/)
- For more information about git merge conflicts in general see [here](https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/about-merge-conflicts)
- For more information about how to resolve merge conflicts using the command line see [here](https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/resolving-a-merge-conflict-using-the-command-line)

## Merging Changes

1. Wait for a review from a maintainer.
2. Address any requested changes.
3. Once approved, a maintainer will merge the pull request. If you have properly
rebased you feature branch on main, this process should not produce any conflicts.
4. After merging, **sync your local repository**:
   ```sh
   git checkout main
   git pull origin main
   ```

## Code Style and Best Practices
- Follow the project's coding style and guidelines. We don't have any yet. Ideas?
- Try to commit often and in an "atomic" way with each change corresponding to one commit. It is much easier to resolve merge conflicts when each commit has a clear purpose. Combining lots of unrelated changes into a single commit can result in very complex merge conflicts.
- Write meaningful commit messages.
- Keep pull requests focused and concise.
- Ensure all tests pass before submitting a PR. We haven't got any yet.
